Build failed
Your deployment attempt had the following errors:
TypeScript compilation errors in server/storage.ts (lines 751, 752, 850)
The build is failing due to syntax errors in the TypeScript files
Missing or incorrect type handling for IDs in database operations
Assistant suggestions
server/storage.ts(751,63): error TS1005: ',' expected.
server/storage.ts(752,7): error TS1128: Declaration or statement expected.
// Fix method signature to handle both string and number types
async getAchievements(learnerId: string | number) {
  return await db.select().from(achievements)
    .where(eq(achievements.learnerId, learnerId.toString()));
}
server/storage.ts(850,87): error TS1005: ';' expected.
server/storage.ts(850,88): error TS1128: Declaration or statement expected.
// Ensure proper syntax and type handling
await db.delete(achievements).where(eq(achievements.learnerId, id.toString()));
// Create scripts/fix-storage-errors.js
const fs = require('fs');
const path = require('path');

function fixStorageFile() {
  try {
    console.log('Fixing server/storage.ts...');
    const filePath = path.join(process.cwd(), 'server/storage.ts');
    
    if (!fs.existsSync(filePath)) {
      console.warn('server/storage.ts not found');
      return;
    }
    
    let content = fs.readFileSync(filePath, 'utf8');
    
    // Fix line 751-752 errors
    content = content.replace(
      /async getAchievements\(learnerId: string\)/g,
      'async getAchievements(learnerId: string | number)'
    );
    
    content = content.replace(
      /\.where\(eq\(achievements\.learnerId, [^)]+\)\)/g,
      '.where(eq(achievements.learnerId, learnerId.toString()))'
    );
    
    // Fix line 850 error
    content = content.replace(
      /await db\.delete\(achievements\)\.where\(eq\(achievements\.learnerId, [^)]+\)\)/g,
      'await db.delete(achievements).where(eq(achievements.learnerId, id.toString()));'
    );
    
    fs.writeFileSync(filePath, content, 'utf8');
    console.log('Fixed server/storage.ts');
  } catch (error) {
    console.error('Error fixing server/storage.ts:', error);
  }
}

fixStorageFile();
console.log('TypeScript compilation fixes applied successfully');
cd client && npm run build && cd .. && TS_NODE_TRANSPILE_ONLY=true npx tsc
cd client && npm run build && cd .. && node scripts/fix-storage-errors.js && TS_NODE_TRANSPILE_